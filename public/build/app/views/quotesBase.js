define(["jquery","lodash","backbone","events","app","text!../../../templates/user_quotebase.phtml","text!../../../templates/add_quote.phtml","quoteAddView","quotesData","dataTable"],function(e,t,n,r,i,s,o,u,a){var f={Views:{}};return f.Views.QuotesBasePageView=n.View.extend({el:".main",initialize:function(){i.vent.on("quote:edit",this.editQuote,this)},render:function(){var t=this;i.quotesCollection===undefined&&(this.collection=new a.Collection,this.collection.fetch().then(function(){t.$el.html(s);var n=(new f.Views.QuotesView({collection:t.collection})).render();e("#user-citabase-table").append(n.el),e("#user-citabase-table").dataTable({sPaginationType:"bootstrap",sDom:'<"top"f>rt<"bottom"p><"clear">'})})),this.$el.html(s);var n=(new f.Views.QuotesView({collection:this.collection})).render();return e("#user-citabase-table").append(n.el),e("#user-citabase-table").dataTable({sPaginationType:"bootstrap",sDom:'<"top"f>rt<"bottom"p><"clear">'}),this},editQuote:function(t){var n=new f.Views.QuoteEditView({model:t});e("#editQuote").html(n.el)}}),f.Views.QuotesView=n.View.extend({tagName:"tbody",initialize:function(){this.collection.on("add",this.addOne,this)},render:function(){return this.collection.each(this.addOne,this),this},addOne:function(e){var t=new f.Views.QuoteView({model:e});this.$el.append(t.render().el)}}),f.Views.QuoteView=n.View.extend({tagName:"tr",template:e("#allQuotesTemplate").html(),initialize:function(){this.model.on("destroy",this.unrender,this),this.model.on("change",this.render,this)},render:function(){var t=e("#allQuotesTemplate").html(),n=Handlebars.compile(t);return this.$el.html(n(this.model.toJSON())),this},events:{"click a.delete":"deleteContact","click a.edit":"editContact"},deleteContact:function(){this.model.destroy()},editContact:function(){i.vent.trigger("quote:edit",this.model)},unrender:function(){this.remove()}}),f.Views.QuoteEditView=n.View.extend({initialize:function(){this.render(),this.form=this.$("#editContact"),this.edit_author=this.form.find("#edit_author"),this.edit_quote=this.form.find("#edit_quote")},events:{"submit #editContact":"submit","click #editContact .cancel":"cancel"},submit:function(e){e.preventDefault(),this.model.save({author:this.edit_author.val(),quote:this.edit_quote.val()}),this.remove()},cancel:function(){this.remove()},render:function(){var t=e("#editQuoteTemplate").html(),n=Handlebars.compile(t);return this.$el.html(n(this.model.toJSON())),this}}),f});